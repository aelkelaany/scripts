select distinct
sgbstdn_pidm AS PIDM_ID , 
SPRIDEN_ID AS "ÑÞã ÇáØÇáÈ" , 
SPBPERS_SSN AS "ÇáÓÌá ÇáãÏäí" ,
(
select distinct SPRTELE_INTL_ACCESS 
from SPRTELE
where SGBSTDN_PIDM=SPRTELE_PIDM(+)
and SPRTELE_TELE_CODE in ('HO','MO')
and rownum=1
) AS "ÑÞã ÇáÌæÇá" ,
SGBSTDN_TERM_CODE_ADMIT AS "ÝÕá ÇáÞÈæá" , 
SPRIDEN_FIRST_NAME||' '||SPRIDEN_MI||' '||SPRIDEN_LAST_NAME AS "ÇÓã ÇáØÇáÈ" , 
SPBPERS_SEX AS SEX_ID ,
decode(SPBPERS_SEX,'M','ÇáØÇáÈ','F','ÇáØÇáÈÉ','ÛíÑ ãÍÏÏ') AS "ÇáÌäÓ" ,
the_email.EMAIL_ADDRESS AS "ÇáÇíãíá" ,
SPBPERS_CITZ_CODE AS CITIZEN_ID ,
STVCITZ_DESC AS "ÇáÌäÓíÉ" ,
sgbstdn_coll_code_1 AS COLLEGE_ID , 
STVCOLL_DESC AS "ÇÓã ÇáßáíÉ" , 
sgbstdn_program_1 AS PROGRAM_ID ,
SMRPRLE_PROGRAM_DESC AS "ÇÓã ÇáÈÑäÇãÌ" ,
sgbstdn_degc_code_1 AS DEGREE_ID , 
STVDEGC_DESC AS "ÇáÏÑÌÉ ÇáÚáãíÉ" , 
sgbstdn_majr_code_1 AS MAJOR_ID ,
STVMAJR_DESC AS "ÇÓã ÇáÊÎÕÕ" ,
sgbstdn_dept_code AS DEPARTMENT_ID ,
STVDEPT_DESC AS "ÇÓã ÇáÞÓã" ,
sgbstdn_stst_code AS STATUS_ID ,
STVSTST_DESC AS "ÍÇáÉ ÇáØÇáÈ" ,
sgbstdn_styp_code AS TYPE_ID ,
STVSTYP_DESC AS "äæÚ ÇáØÇáÈ" ,
shr.gpa AS "ãÚÏá ÊÑÇßãí" ,
shr.hours AS "ÓÇÚÇÊ ÅäÌÇÒ" ,
NVL(THE_PROG.THE_HOURS,0) AS "ÓÇÚÇÊ ÇáÎØÉ" ,
NVL(THE_PROG.THE_HOURS,0)-shr.hours AS "ÝÑÞ ÇáÓÇÚÇÊ" ,
DECODE(THE_SMBPOGN.MET_IND,'Y','äÚã','N','áÇ','ÛíÑ ãÍÏÏ') AS "Ãßãá ÇáãæÇÏ",
THE_SMBPOGN.REQ_CREDITS_OVERALL AS "ÓÇÚÉ-Çáßá",
THE_SMBPOGN.ACT_CREDITS_OVERALL AS "ÓÇÚÉ-ãÊÍÞÞ",
THE_SMBPOGN.REQ_COURSES_OVERALL AS "ãæÇÏ-Çáßá", 
THE_SMBPOGN.ACT_COURSES_OVERALL AS "ãæÇÏ-ãÊÍÞÞ",
the_mark.SHRTTRM_ASTD_CODE_END_OF_TERM AS GRADE_ID ,
STVASTD_DESC AS "ÇáÊÞÏíÑ" ,
GORIMMU_COMMENT AS "ÑÞã ÇáÃíÈÇä" ,
GORIMMU_IMST_CODE AS "IBAN_STATUS" ,
GTVIMST_DESC AS "ÍÇáÉ ÇáÂíÈÇä" ,
GORIMMU_IMMU_CODE AS "BANK_ID" ,
GTVIMMU_DESC AS "ÇÓã ÇáÈäß",
SORHSCH_SBGI_CODE AS "Qualification",
STVSBGI_DESC AS "ÇáãÄåá ÇáÏÑÇÓí",
SORHSCH_DPLM_CODE AS "High_School_TYPE",
STVDPLM_DESC AS "ÔåÇÏÉ ÇáËÇäæíÉ",
SORHSCH_GPA AS "ãÚÏá ÇáËÇäæíÉ",
QIYAS.THE_SCORE AS "ÇáÞíÇÓ",
Tahsili.THE_SCORE AS "ÇáÊÍÕíáí",
DOUBLE_RATIO.THE_SCORE AS "ÇáËäÇÆíÉ",
TRIPLE_RATIO_1.THE_SCORE AS "ÇáËáÇËíÉ 1",
TRIPLE_RATIO_2.THE_SCORE AS "ÇáËáÇËíÉ 2"
from sgbstdn sg , SPRIDEN , SPBPERS , general.GORIMMU , SMRPRLE , STVDEPT , STVCOLL , STVDEGC , STVMAJR , STVSTST , STVSTYP , STVCITZ , STVASTD , GTVIMST , GTVIMMU , SORHSCH , STVDPLM , STVSBGI ,  
(select SHRTGPA_pidm ,
round(DECODE(SUM(SHRTGPA_GPA_HOURS),0,0,SUM(SHRTGPA_QUALITY_POINTS) / SUM(SHRTGPA_GPA_HOURS)),2)  gpa,
SUM(SHRTGPA_HOURS_EARNED) hours
from SHRTGPA 
group by SHRTGPA_pidm ) shr ,
(
SELECT DISTINCT GOREMAL_PIDM AS PIDM , GOREMAL_EMAIL_ADDRESS AS EMAIL_ADDRESS
FROM GOREMAL GO
WHERE GOREMAL_EMAIL_ADDRESS =(SELECT DISTINCT GOREMAL_EMAIL_ADDRESS
                            FROM GOREMAL 
                            WHERE GOREMAL_PIDM=GO.GOREMAL_PIDM
                            AND GOREMAL_EMAL_CODE='PS'
                            AND ROWNUM=1)
) the_email ,
(
select SHRTTRM_pidm , SHRTTRM_ASTD_CODE_END_OF_TERM
from SHRTTRM sh
where SHRTTRM_TERM_CODE=( select max(SHRTTRM_TERM_CODE) 
                          from SHRTTRM 
                          where SHRTTRM_PIDM=sh.SHRTTRM_PIDM )
) the_mark ,
(
SELECT SMBPGEN_PROGRAM AS THE_PROGRAM , MIN(SMBPGEN_REQ_CREDITS_OVERALL) AS THE_HOURS
FROM SMBPGEN
GROUP BY SMBPGEN_PROGRAM
) THE_PROG,
(
SELECT DISTINCT
SORTEST_PIDM AS THE_PIDM,
SORTEST_TEST_SCORE AS THE_SCORE
FROM SORTEST
WHERE SORTEST_TESC_CODE='ÊÍÕá'
) Tahsili,
(
SELECT DISTINCT
SORTEST_PIDM AS THE_PIDM,
SORTEST_TEST_SCORE AS THE_SCORE
FROM SORTEST
WHERE SORTEST_TESC_CODE='äÓÈÉ'
) TRIPLE_RATIO_1,
(
SELECT DISTINCT
SORTEST_PIDM AS THE_PIDM,
SORTEST_TEST_SCORE AS THE_SCORE
FROM SORTEST
WHERE SORTEST_TESC_CODE='äÓÈ2'
) TRIPLE_RATIO_2,
(
SELECT DISTINCT
SORTEST_PIDM AS THE_PIDM,
SORTEST_TEST_SCORE AS THE_SCORE
FROM SORTEST
WHERE SORTEST_TESC_CODE='ÞíÇÓ'
) QIYAS,
(
SELECT DISTINCT 
SARRRAT_PIDM AS THE_PIDM,
SARRRAT_TERM_CODE AS THE_TERM,
MIN(SARRRAT_RATING) AS THE_SCORE
FROM SARRRAT 
WHERE SARRRAT_RATP_CODE='Ïã.ß'
AND SARRRAT_RADM_CODE='RATER'
GROUP BY SARRRAT_PIDM , SARRRAT_TERM_CODE
) DOUBLE_RATIO ,
(
SELECT DISTINCT
SMBPOGN_PIDM AS PIDM,
SMBPOGN_REQUEST_NO AS REQUEST_NO,
SMBPOGN_MET_IND AS MET_IND,
SMBPOGN_REQ_CREDITS_OVERALL AS REQ_CREDITS_OVERALL,
SMBPOGN_REQ_COURSES_OVERALL AS REQ_COURSES_OVERALL,
SMBPOGN_ACT_CREDITS_OVERALL AS ACT_CREDITS_OVERALL,
SMBPOGN_ACT_COURSES_OVERALL AS ACT_COURSES_OVERALL
FROM SMBPOGN SMB
WHERE SMBPOGN_REQUEST_NO=(SELECT MAX(SMBPOGN_REQUEST_NO)
                          FROM SMBPOGN
                          WHERE SMBPOGN_PIDM=SMB.SMBPOGN_PIDM) 
) THE_SMBPOGN 
where to_number(trim(both ' ' from sgbstdn_term_code_eff))=( select max(to_number(trim(both ' ' from sgbstdn_term_code_eff))) 
                                                             from sgbstdn 
                                                             where sgbstdn_pidm=sg.sgbstdn_pidm )
and sgbstdn_pidm=SPRIDEN_PIDM(+)
and SPRIDEN_CHANGE_IND is null
AND sgbstdn_pidm=THE_SMBPOGN.PIDM(+)
and sgbstdn_pidm=SPBPERS_PIDM(+)
and sgbstdn_pidm=GORIMMU_PIDM(+)
and GORIMMU_IMST_CODE(+)='AC'
and sgbstdn_pidm=shr.SHRTGPA_pidm(+)
and sgbstdn_pidm=the_email.PIDM(+)
and sgbstdn_pidm=the_mark.SHRTTRM_pidm(+)
and the_mark.SHRTTRM_ASTD_CODE_END_OF_TERM=STVASTD_CODE(+)
and SGBSTDN_PROGRAM_1=SMRPRLE_PROGRAM(+)
and SMRPRLE_PROGRAM=THE_PROG.THE_PROGRAM(+)
and sgbstdn_dept_code=STVDEPT_CODE(+)
and sgbstdn_coll_code_1=STVCOLL_CODE(+)
and sgbstdn_degc_code_1=STVDEGC_CODE(+)
and sgbstdn_majr_code_1=STVMAJR_CODE(+)
and sgbstdn_stst_code=stvstst_code(+)
and sgbstdn_styp_code=STVSTYP_CODE(+)
and SPBPERS_CITZ_CODE=STVCITZ_CODE(+)
and GORIMMU_IMST_CODE=GTVIMST_CODE(+)
and GORIMMU_IMMU_CODE=GTVIMMU_CODE(+)
and sgbstdn_pidm=SORHSCH_PIDM(+)
and SORHSCH_DPLM_CODE=STVDPLM_code(+)
and SORHSCH_SBGI_CODE=STVSBGI_code(+)
and sgbstdn_pidm=Tahsili.THE_PIDM(+)
and sgbstdn_pidm=TRIPLE_RATIO_1.THE_PIDM(+)
and sgbstdn_pidm=TRIPLE_RATIO_2.THE_PIDM(+)
and sgbstdn_pidm=QIYAS.THE_PIDM(+)
and sgbstdn_pidm=DOUBLE_RATIO.THE_PIDM(+)
and SGBSTDN_TERM_CODE_ADMIT=DOUBLE_RATIO.THE_TERM(+)
and sgbstdn_stst_code='AS'
and sgbstdn_styp_code='ã'
and sgbstdn_degc_code_1 in ('Èß Ê','Èß')
and THE_SMBPOGN.MET_IND='N'
and ( (THE_SMBPOGN.ACT_CREDITS_OVERALL>=THE_SMBPOGN.REQ_CREDITS_OVERALL) or (THE_SMBPOGN.ACT_COURSES_OVERALL>=THE_SMBPOGN.REQ_COURSES_OVERALL) )
AND THE_SMBPOGN.ACT_CREDITS_OVERALL>=100
AND sgbstdn_coll_code_1=:THE_COLLEGE
order by sgbstdn_coll_code_1 asc , SPRIDEN_ID asc