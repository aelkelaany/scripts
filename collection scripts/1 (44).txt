SELECT DISTINCT
SIRASGN_PIDM AS "PIDM",
SPRIDEN_ID AS "—ﬁ„ «·„œ—”",
SPRIDEN_FIRST_NAME||' '||SPRIDEN_MI||' '||SPRIDEN_LAST_NAME AS "«”„ «·„œ—”",
SIRDPCL_COLL_CODE AS "—ﬁ„ «·ﬂ·Ì…",
STVCOLL_DESC AS "«”„ «·ﬂ·Ì…",
SIRDPCL_DEPT_CODE AS "—ﬁ„ «·ﬁ”„",
STVDEPT_DESC AS "«”„ «·ﬁ”„",
NVL(THE_THEORETICAL.THE_TOTAL,0) AS "”«⁄…-‰Ÿ—Ì",
NVL(THE_PRACTICAL.THE_TOTAL,0) AS "”«⁄…-⁄„·Ì",
(NVL(THE_THEORETICAL.THE_TOTAL,0)+NVL(THE_PRACTICAL.THE_TOTAL,0)) AS "”«⁄…-≈Ã„«·Ì"
FROM SIRASGN , SPRIDEN , STVCOLL , STVDEPT ,
(
SELECT DISTINCT
SIRDPCL_PIDM,
SIRDPCL_COLL_CODE,
SIRDPCL_DEPT_CODE
FROM SIRDPCL SI
WHERE TRIM(BOTH ' ' FROM SIRDPCL_TERM_CODE_EFF)=(SELECT MAX(TRIM(BOTH ' ' FROM SIRDPCL_TERM_CODE_EFF)) 
                                                 FROM SIRDPCL 
                                                 WHERE SIRDPCL_PIDM=SI.SIRDPCL_PIDM)
) THE_SIRDPCL ,
(
SELECT DISTINCT
SIRASGN_PIDM AS THE_PIDM,
SUM(NVL(SCBCRSE_LEC_HR_LOW,0)) AS THE_TOTAL
FROM  SSBSECT , SIRASGN ,
(
SELECT DISTINCT
SCBCRSE_SUBJ_CODE,
SCBCRSE_CRSE_NUMB,
SCBCRSE_LEC_HR_LOW
FROM SCBCRSE SC
WHERE SCBCRSE_EFF_TERM=(SELECT max(SCBCRSE_EFF_TERM)
                        FROM SCBCRSE 
                        WHERE SCBCRSE_CRSE_NUMB=SC.SCBCRSE_CRSE_NUMB
                        AND SCBCRSE_SUBJ_CODE=SC.SCBCRSE_SUBJ_CODE)
) THE_SCBCRSE                       
WHERE SSBSECT_TERM_CODE=:THE_TERM
AND SSBSECT_SCHD_CODE IN ('‰','„')
AND SSBSECT_SUBJ_CODE=THE_SCBCRSE.SCBCRSE_SUBJ_CODE(+)
AND SSBSECT_CRSE_NUMB=THE_SCBCRSE.SCBCRSE_CRSE_NUMB(+)
AND SSBSECT_CRN=SIRASGN_CRN(+)
AND SSBSECT_TERM_CODE=SIRASGN_TERM_CODE(+)
GROUP BY SIRASGN_PIDM
) THE_THEORETICAL ,
(
SELECT DISTINCT
SIRASGN_PIDM AS THE_PIDM,
SUM(NVL(SCBCRSE_LAB_HR_LOW,0)) AS THE_TOTAL
FROM  SSBSECT , SIRASGN ,
(
SELECT DISTINCT
SCBCRSE_SUBJ_CODE,
SCBCRSE_CRSE_NUMB,
SCBCRSE_LAB_HR_LOW
FROM SCBCRSE SC
WHERE SCBCRSE_EFF_TERM=(SELECT max(SCBCRSE_EFF_TERM)
                        FROM SCBCRSE 
                        WHERE SCBCRSE_CRSE_NUMB=SC.SCBCRSE_CRSE_NUMB
                        AND SCBCRSE_SUBJ_CODE=SC.SCBCRSE_SUBJ_CODE)
) THE_SCBCRSE                       
WHERE SSBSECT_TERM_CODE=:THE_TERM
AND SSBSECT_SCHD_CODE IN ('⁄','„','”','—')
AND SSBSECT_SUBJ_CODE=THE_SCBCRSE.SCBCRSE_SUBJ_CODE(+)
AND SSBSECT_CRSE_NUMB=THE_SCBCRSE.SCBCRSE_CRSE_NUMB(+)
AND SSBSECT_CRN=SIRASGN_CRN(+)
AND SSBSECT_TERM_CODE=SIRASGN_TERM_CODE(+)
GROUP BY SIRASGN_PIDM
) THE_PRACTICAL
WHERE SIRASGN_TERM_CODE=:THE_TERM
AND SIRASGN_PIDM=SIRDPCL_PIDM(+)
AND SIRASGN_PIDM=SPRIDEN_PIDM(+)
AND SPRIDEN_CHANGE_IND IS NULL
AND SIRDPCL_COLL_CODE=STVCOLL_CODE(+)
AND SIRDPCL_DEPT_CODE=STVDEPT_CODE(+)
AND SIRASGN_PIDM=THE_THEORETICAL.THE_PIDM(+)
AND SIRASGN_PIDM=THE_PRACTICAL.THE_PIDM(+)
AND SIRDPCL_COLL_CODE=:THE_COLLEGE

